@model ImageApp.Application.DTOs.Photos.PhotoResponse

<h2>@Model.Title</h2>

<div class="photo-detail">
    <img src="@Model.OriginalUrl" alt="@Model.Title" />
    <p>@Model.Caption</p>
    <p><strong>Location:</strong> @Model.Location</p>
    <p><strong>People:</strong> @(Model.PeoplePresent.Count == 0 ? "-" : string.Join(", ", Model.PeoplePresent))</p>
    <p><strong>Rating:</strong> @Model.AverageRating (@Model.TotalRatings)</p>
    
    <p class="text-muted">
        Uploaded on @Model.CreatedAt.ToString("yyyy-MM-dd HH:mm")
    </p>

    <hr />

    <h4>Comments (@Model.Comments.Count)</h4>
    
    @if (!Model.Comments.Any())
    {
        <p class="text-muted">No comments yet.</p>
    }
    else
    {
        <div class="mt-3">
            @foreach (var comment in Model.Comments)
            {
                <div class="mb-3 p-3 border rounded">
                    <strong>@comment.UserDisplayName</strong>
                    <span class="text-muted ms-2" style="font-size: 0.9em;">
                        @comment.CreatedAt.ToString("yyyy-MM-dd HH:mm")
                    </span>

                    <div class="mt-2">
                        @comment.Text
                    </div>
                </div>
            }
        </div>
    }

    @if (User.Identity?.IsAuthenticated == true)
    {
        <form method="post" action="/photos/@Model.Id/rate" class="inline">
            <label>Rate:</label>
            <select name="score">
                <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
            </select>
            <button type="submit">Submit</button>
        </form>

        <form method="post" action="/photos/@Model.Id/comment" class="inline">
            <input name="text" placeholder="Write a comment..." />
            <button type="submit">Comment</button>
        </form>
    }
    else
    {
        <p><a href="/Auth/Login">Login</a> to comment or rate.</p>
    }
</div>